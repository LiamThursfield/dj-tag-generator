import{_ as T}from"./AudioEffectsSelector.vue_vue_type_script_setup_true_lang-xJvAEBYG.js";import{_ as L,a as B,b as q,c as F}from"./index-Csmrucm_.js";import{a as J,q as R,d as z,_ as C}from"./index-xZq3DilE.js";import{i as $,a as G,_ as O,r as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-gBe-ffs_.js";import{d as U,a as w,G as H,x as I,c as n,b as m,u as i,h as Y,w as p,e,f as j,g as c,o as d,i as g,t as l,F as A,m as K,n as D,l as M,J as W}from"./app-CwyS4INj.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DOggCLRA.js";import"./useForwardPropsEmits-CVO52EX_.js";import"./VisuallyHidden-CMrQVpRF.js";import"./index-BQh8QZ4Y.js";import"./useForwardExpose-DXTqR5bV.js";import"./check-BVcBtqcH.js";import"./Label.vue_vue_type_script_setup_true_lang-DSJ19Ave.js";import"./music-DK91P6wk.js";const a=(t,s)=>({url:a.url(t,s),method:"get"});a.definition={methods:["get","head"],url:"/play/{version}"};a.url=(t,s)=>{(typeof t=="string"||typeof t=="number")&&(t={version:t}),typeof t=="object"&&!Array.isArray(t)&&"id"in t&&(t={version:t.id}),Array.isArray(t)&&(t={version:t[0]}),t=J(t);const x={version:typeof t.version=="object"?t.version.id:t.version};return a.definition.url.replace("{version}",x.version.toString()).replace(/\/+$/,"")+R(s)};a.get=(t,s)=>({url:a.url(t,s),method:"get"});a.head=(t,s)=>({url:a.url(t,s),method:"head"});const V=(t,s)=>({action:a.url(t,s),method:"get"});V.get=(t,s)=>({action:a.url(t,s),method:"get"});V.head=(t,s)=>({action:a.url(t,{[s?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...s?.query??s?.mergeQuery??{}}}),method:"get"});a.form=V;Object.assign(a,a);const X={class:"mx-auto max-w-5xl space-y-6 p-4 sm:p-6 lg:p-8"},Z={class:"overflow-hidden border border-border bg-card shadow sm:rounded-lg"},ee={class:"flex items-center justify-between px-4 py-5 sm:px-6"},te={class:"mt-1 max-w-2xl text-sm text-gray-500 dark:text-gray-400"},se={class:"border-t border-gray-200 px-4 py-5 sm:p-0 dark:border-gray-700"},re={class:"sm:divide-y sm:divide-gray-200 dark:sm:divide-gray-700"},oe={class:"py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6 sm:py-5"},ae={class:"mt-1 text-sm text-gray-900 italic sm:col-span-2 sm:mt-0 dark:text-gray-100"},ie={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},de={class:"space-y-4 lg:col-span-2"},le={class:"flex items-center justify-between bg-muted/30 px-4 py-4 sm:px-6"},ne={class:"flex items-center space-x-3"},ce={class:"text-sm font-bold tracking-wider text-foreground uppercase"},ue={class:"flex items-center space-x-4"},me=["onClick"],pe={class:"space-y-4 p-4 sm:p-6"},fe={key:0,class:"space-y-3 rounded-lg border border-primary/20 bg-primary/5 p-4"},ge={class:"flex items-center justify-between text-xs font-bold tracking-widest text-primary uppercase"},xe={controls:"",class:"h-8 w-full"},ye=["src"],_e={key:1,class:"space-y-3"},he={controls:"",class:"w-full"},be=["src"],ve={class:"flex items-center justify-between"},ke={class:"text-xs text-gray-500 italic dark:text-gray-400"},we=["href"],Ve={key:2,class:"rounded border border-red-100 bg-red-50 p-3 dark:border-red-900/30 dark:bg-red-900/10"},Ce={class:"text-xs font-medium text-red-600 dark:text-red-400"},$e={key:3,class:"flex items-center justify-center p-8"},je={class:"space-y-4"},Ae={class:"sticky top-6 overflow-hidden border border-border bg-card shadow sm:rounded-lg"},De={class:"space-y-4 p-4"},Ee={key:0,class:"mt-2 text-center text-xs text-destructive"},Ne={key:1,class:"mt-2 text-center text-xs text-muted-foreground"},Se={class:"flex justify-start border-t border-border pt-4"},Ie=U({__name:"Show",props:{tag:{},tagVersionLimit:{}},setup(t){const s=t,x=w(()=>s.tag.versions.length>=s.tagVersionLimit),h=w(()=>s.tag.versions.length===0||s.tag.versions.some(u=>u.status==="pending"||u.status==="processing")),E=()=>{W.reload()},N=[{title:"Dashboard",href:z.url()},{title:"DJ Tags",href:$.url()},{title:`Tag #${s.tag.id}`,href:G.url(s.tag.id)}],S=u=>{switch(u){case"completed":return"bg-emerald-500/10 text-emerald-500";case"failed":return"bg-destructive/10 text-destructive";case"processing":return"bg-primary/10 text-primary";default:return"bg-muted text-muted-foreground"}},v=u=>u?a.url(u):null,f=w(()=>s.tag.versions[0]||null),y=H({audio_effects:{...{pitch:0,speed:1,reverb:"none",bass_boost:!1,tremolo:!1,echo:!1,chorus:!1,lofi_telephone:!1,bitcrush:!1,normalize:!0},...f.value?.audio_effects||{}}}),P=()=>{y.post(Q.url(s.tag.id),{preserveScroll:!0,onSuccess:()=>{}})},b=I(null);return(u,o)=>(d(),n(A,null,[m(i(Y),{title:`Tag #${t.tag.id}`},null,8,["title"]),m(O,{breadcrumbs:N},{default:p(()=>[e("div",X,[h.value?(d(),j(i(L),{key:0,class:"border-primary/50 bg-primary/10"},{default:p(()=>[m(i(B),{class:"flex items-center justify-between"},{default:p(()=>[o[2]||(o[2]=e("span",{class:"flex items-center gap-2"},[e("span",{class:"h-2 w-2 animate-pulse rounded-full bg-primary"}),g(" Processing ")],-1)),m(i(C),{variant:"outline",size:"sm",class:"h-7 text-xs",onClick:E},{default:p(()=>[...o[1]||(o[1]=[g(" Refresh Status ",-1)])]),_:1})]),_:1}),m(i(q),{class:"mt-2"},{default:p(()=>[...o[3]||(o[3]=[g(" One or more versions are currently being processed. Please refresh the page periodically to check for updates. ",-1)])]),_:1})]),_:1})):c("",!0),e("div",Z,[e("div",ee,[e("div",null,[o[4]||(o[4]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"}," DJ Tag Details ",-1)),e("p",te," Generated via "+l(t.tag.service)+" (Voice: "+l(t.tag.voice_id)+") ",1)])]),e("div",se,[e("dl",re,[e("div",oe,[o[5]||(o[5]=e("dt",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"}," Script Text ",-1)),e("dd",ae,' "'+l(t.tag.text)+'" ',1)])])])]),e("div",ie,[e("div",de,[(d(!0),n(A,null,K(t.tag.versions,r=>(d(),n("div",{key:r.id,class:D(["overflow-hidden border border-border bg-card shadow sm:rounded-lg",{"border-primary ring-1 ring-primary":r.id===f.value?.id}])},[e("div",le,[e("div",ne,[e("span",ce," Version "+l(r.version_number),1),r.id===f.value?.id?(d(),j(i(F),{key:0,variant:"secondary",class:"text-xs uppercase"},{default:p(()=>[...o[6]||(o[6]=[g(" Current ",-1)])]),_:1})):c("",!0)]),e("div",ue,[e("span",{class:D(["rounded-full px-2.5 py-0.5 text-xs font-bold tracking-wide uppercase",S(r.status)])},l(r.status),3),r.status==="completed"&&r.id!==f.value?.id?(d(),n("button",{key:0,onClick:k=>b.value=b.value===r.id?null:r.id,class:"text-xs font-semibold text-primary hover:text-primary/80"},l(b.value===r.id?"Hide Comparison":"Compare"),9,me)):c("",!0)])]),e("div",pe,[b.value===r.id?(d(),n("div",fe,[e("div",ge,[o[7]||(o[7]=e("span",null,"Comparison",-1)),e("span",null,"Version "+l(f.value?.version_number)+" (Current)",1)]),e("audio",xe,[e("source",{src:v(f.value?.id),type:"audio/mpeg"},null,8,ye)])])):c("",!0),r.status==="completed"&&r.audio_path?(d(),n("div",_e,[e("audio",he,[e("source",{src:v(r.id),type:"audio/mpeg"},null,8,be)]),e("div",ve,[e("div",ke," Effects: "+l(r.audio_effects&&Object.entries(r.audio_effects).filter(([k,_])=>_&&_!==1&&_!==0).map(([k,_])=>`${k}: ${_}`).join(", ")||"None"),1),e("a",{href:v(r.id),download:"",class:"text-xs font-bold tracking-wider text-indigo-600 uppercase hover:text-indigo-800 hover:underline dark:text-indigo-400 dark:hover:text-indigo-300"}," Download ",8,we)])])):c("",!0),r.status==="failed"?(d(),n("div",Ve,[e("p",Ce," Error: "+l(r.error_message),1)])):c("",!0),r.status==="processing"||r.status==="pending"?(d(),n("div",$e,[...o[8]||(o[8]=[e("div",{class:"h-8 w-8 animate-spin rounded-full border-b-2 border-primary"},null,-1)])])):c("",!0)])],2))),128))]),e("div",je,[e("div",Ae,[o[9]||(o[9]=e("div",{class:"border-b border-border bg-muted/30 px-4 py-4 sm:px-6"},[e("h4",{class:"text-sm font-bold tracking-wider text-foreground uppercase"}," Experiment with Effects "),e("p",{class:"mt-1 text-xs text-muted-foreground"}," Create a new version using the raw master audio. No extra AI credits used. ")],-1)),e("div",De,[m(T,{modelValue:i(y).audio_effects,"onUpdate:modelValue":o[0]||(o[0]=r=>i(y).audio_effects=r),compact:""},null,8,["modelValue"]),m(i(C),{onClick:P,disabled:i(y).processing||x.value||h.value,class:"mt-4 h-10 w-full text-xs tracking-widest uppercase"},{default:p(()=>[g(l(i(y).processing?"Generating...":x.value?"Version Limit Reached":h.value?"Processing in Progress...":"Create New Version"),1)]),_:1},8,["disabled"]),x.value?(d(),n("p",Ee," You have reached the maximum of "+l(t.tagVersionLimit)+" versions for this tag. ",1)):c("",!0),h.value?(d(),n("p",Ne," Please wait for current processing to complete. ")):c("",!0)])])])]),e("div",Se,[m(i(M),{href:i($).url(),class:"flex items-center text-xs font-bold tracking-widest text-muted-foreground uppercase hover:text-foreground"},{default:p(()=>[...o[10]||(o[10]=[g(" â† Back to DJ Tags ",-1)])]),_:1},8,["href"])])])]),_:1})],64))}});export{Ie as default};
